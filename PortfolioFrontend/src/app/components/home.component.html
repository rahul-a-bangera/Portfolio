<section id="home" class="home-container">
<!-- Ambient Components -->
<app-dot-grid *ngIf="ambientSettings.dotGrid"></app-dot-grid>
<app-system-stats *ngIf="ambientSettings.systemStats"></app-system-stats>
<app-click-spark *ngIf="ambientSettings.clickSpark"></app-click-spark>

<div class="home-card-wrapper">
<mat-card class="home-card" *ngIf="profileData && resumeData && !isLoadingProfile && !isLoadingResume; else loadingState">
  <div class="card-header">
    <div class="profile-image">
      <!-- Profile picture from API (if available) -->
      <img *ngIf="profileImageUrl" 
           [src]="profileImageUrl" 
           alt="Profile Picture"
           class="profile-picture"
           (error)="onProfileImageError()" />
      <!-- Fallback to initials avatar -->
      <div *ngIf="!profileImageUrl" class="initials-avatar">{{ getInitials() }}</div>
    </div>
    <h1 class="profile-name">{{ profileData.name }}</h1>
    <p class="profile-title">{{ profileData.specialistContent }}</p>
  </div>
    <mat-card-content class="card-content">
      <p class="card-description">
        {{ resumeData.shortSummary }}
      </p>
    <div class="card-actions">
      <button mat-raised-button class="cta-button primary" (click)="downloadCV()">
        <mat-icon>download</mat-icon>
        Download CV
      </button>
    </div>
    <div class="social-links">
      <a *ngIf="resumeData.personalInfo.linkedin" 
         [href]="resumeData.personalInfo.linkedin" 
         target="_blank" 
         rel="noopener noreferrer" 
         class="social-link linkedin" 
         title="Connect on LinkedIn">
        <mat-icon>link</mat-icon>
        <span class="social-label">LinkedIn</span>
      </a>
      <button mat-button class="social-link contact" title="Contact Information" (click)="toggleContactPopup()">
        <mat-icon>email</mat-icon>
        <span class="social-label">Contact</span>
      </button>
    </div>
  </mat-card-content>
</mat-card>

<ng-template #loadingState>
  <mat-card class="home-card loading-card">
    <div class="loading-state">
      <mat-icon>hourglass_empty</mat-icon>
      <p>Loading profile...</p>
    </div>
  </mat-card>
</ng-template>

    <!-- Contact Info Popup -->
    <div class="contact-popup-overlay" *ngIf="showContactPopup" (click)="closeContactPopup()">
      <mat-card class="contact-popup-card" (click)="$event.stopPropagation()">
        <mat-card-header>
          <mat-card-title class="popup-title">
            <mat-icon>contact_mail</mat-icon>
            Contact Information
          </mat-card-title>
          <button mat-icon-button class="close-button" (click)="closeContactPopup()">
            <mat-icon>close</mat-icon>
          </button>
        </mat-card-header>
        <mat-card-content class="popup-content">
          <div class="contact-item">
            <mat-icon class="contact-icon">email</mat-icon>
            <div class="contact-details">
              <label class="contact-label">Email</label>
              <div class="contact-value-wrapper">
                <input type="text" readonly [value]="emailId" class="contact-input" #emailInput>
                <button mat-raised-button class="copy-button" (click)="copyToClipboard(emailId, 'Email')">
                  <mat-icon>content_copy</mat-icon>
                  Copy
                </button>
              </div>
            </div>
          </div>
          <div class="contact-item">
            <mat-icon class="contact-icon">phone</mat-icon>
            <div class="contact-details">
              <label class="contact-label">Mobile</label>
              <div class="contact-value-wrapper">
                <input type="text" readonly [value]="mobileNo" class="contact-input" #mobileInput>
                <button mat-raised-button class="copy-button" (click)="copyToClipboard(mobileNo, 'Mobile number')">
                  <mat-icon>content_copy</mat-icon>
                  Copy
                </button>
              </div>
            </div>
          </div>
          <div class="copied-message" *ngIf="showCopiedMessage">
            {{ copiedMessageText }}
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</section>

